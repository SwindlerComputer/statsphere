============================================================
STATSPHERE - BALLON D'OR PREDICTION MODEL
============================================================
Written for: Final Year Project Defence
============================================================

OVERVIEW
--------
StatSphere predicts who is most likely to win the Ballon d'Or award
using TWO approaches:

  1. Frontend Rule-Based Scoring (BallonDor.js)
     - Simple weighted formula calculated in the browser
     - No machine learning needed

  2. Machine Learning Model (ml/ folder)
     - Python-based scikit-learn regression model
     - Trained on player statistics
     - Outputs a predicted score for each player

Both approaches rank players from highest to lowest predicted score.


PART 1: FRONTEND RULE-BASED SCORING (BallonDor.js)
----------------------------------------------------

Location: frontend/src/pages/BallonDor.js

This is a simple mathematical formula that calculates a score
for each player based on their stats.

THE FORMULA:
  Score = [(Goals x 4) + (Assists x 3) + (xG x 2) + (xA x 2) + (Goals/90 x 50)] x League Weight

Each stat has a "weight" (multiplier) showing its importance:
  - Goals × 4       → Goals are the most important (highest weight)
  - Assists × 3     → Assists are important but less than goals
  - xG × 2          → Expected goals show shot quality
  - xA × 2          → Expected assists show creative ability
  - Goals/90 × 50   → Consistency (scoring rate per game)

LEAGUE WEIGHTS:
  The Ballon d'Or considers league difficulty.
  Scoring 20 goals in the Premier League is harder than in weaker leagues.

  Premier League:    1.0  (100% - hardest league)
  La Liga:           0.95 (95%)
  Serie A:           0.90 (90%)
  Bundesliga:        0.90 (90%)
  Ligue 1:           0.85 (85%)
  Super Lig:         0.75 (75%)
  Saudi Pro League:  0.70 (70% - easiest league)

EXAMPLE CALCULATION:
  Player: Cristiano Ronaldo (Al Nassr, Saudi Pro League)
    Goals = 22, Assists = 7, xG = 19.4, xA = 5.2, Goals/90 = 0.85

  Step 1: Goals points     = 22 × 4  = 88
  Step 2: Assists points   = 7 × 3   = 21
  Step 3: xG points        = 19.4 × 2 = 38.8
  Step 4: xA points        = 5.2 × 2  = 10.4
  Step 5: Consistency      = 0.85 × 50 = 42.5
  Step 6: Raw total        = 88 + 21 + 38.8 + 10.4 + 42.5 = 200.7
  Step 7: Apply league weight = 200.7 × 0.7 = 140.5

  Final Score: 140.5

HOW THE RANKING WORKS:
  1. Calculate score for each player
  2. Sort all players by score (highest first)
  3. Display with medals: Gold, Silver, Bronze for top 3
  4. Show score breakdown for the #1 ranked player


PART 2: MACHINE LEARNING MODEL (Python)
-----------------------------------------

Location: /ml/

This is a proper machine learning approach using Python.
It trains a regression model to predict Ballon d'Or scores.

FILES:
  - train.py          → Trains the model on player data
  - predict.py        → Uses trained model to make predictions
  - features.py       → Feature engineering (data preparation)
  - model.pkl         → Saved trained model (pickle file)
  - feature_columns.pkl → Saved list of features used
  - data/raw/players.csv         → Raw player data
  - data/processed/predictions.csv → Output predictions

WHAT IS A REGRESSION MODEL?
  - A regression model predicts a CONTINUOUS number
  - Input: Player stats (goals, assists, xG, minutes, etc.)
  - Output: A predicted score (e.g. 145.3)
  - The model learns patterns from the training data
  - Then uses those patterns to predict new scores

FEATURE ENGINEERING (features.py):
  Raw stats are transformed into useful features:

  1. goals_per_90 = (goals / minutes_played) × 90
     → Shows how often a player scores per full game

  2. assists_per_90 = (assists / minutes_played) × 90
     → Shows how often a player creates goals per full game

  3. league_weight = weight based on league name
     → Same league weights as the frontend formula

  These features help the model understand player quality better
  than just looking at raw numbers.

TRAINING PROCESS (train.py):
  Step 1: Load player data from CSV file
  Step 2: Add calculated features (goals_per_90, etc.)
  Step 3: Select feature columns (inputs to the model)
  Step 4: Define the target variable (score to predict)
  Step 5: Train the model using scikit-learn
  Step 6: Save the trained model to model.pkl

PREDICTION PROCESS (predict.py):
  Step 1: Load the saved model from model.pkl
  Step 2: Load new player data from CSV
  Step 3: Add the same calculated features
  Step 4: Pass features through the model
  Step 5: Model outputs a predicted score for each player
  Step 6: Sort by score (highest first)
  Step 7: Save ranked predictions to CSV

MODEL TYPE:
  The model uses scikit-learn's regression algorithm.
  Scikit-learn is a popular Python library for machine learning.
  The model file (model.pkl) is saved using Python's pickle module,
  which serialises the trained model so it can be loaded later.


PART 3: PLAYER INSIGHTS RULE-BASED SYSTEM (NEW)
--------------------------------------------------

Location: frontend/src/pages/PlayerInsights.js

This is a different kind of prediction system - a "rule-based expert system"
that analyses individual player strengths and weaknesses.

HOW IT WORKS:
  - Simple IF/THEN rules check each stat against threshold values
  - Different rules apply to different positions
  - Results are displayed as "Strengths" and "Weaknesses"

EXAMPLE RULES:
  IF goals >= 20       THEN strength = "Elite Finisher"
  IF goals >= 12       THEN strength = "Clinical Scorer"
  IF assists >= 12     THEN strength = "Elite Playmaker"
  IF tackles >= 80     THEN strength = "Defensive Wall"
  IF passes >= 2000    THEN strength = "Pass Master"
  IF rating >= 8.0     THEN strength = "World Class Rating"

  IF forward AND goals < 5    THEN weakness = "Poor Goal Output"
  IF defender AND tackles < 40 THEN weakness = "Weak Defensively"
  IF midfielder AND assists < 3 THEN weakness = "Low Creativity"

WHAT IS A RULE-BASED EXPERT SYSTEM?
  - One of the oldest forms of artificial intelligence
  - Humans define the rules (not learned from data)
  - Simple but effective for well-defined domains
  - Easy to understand and explain
  - Used in medical diagnosis, fraud detection, sports analysis

COMPARISON OF APPROACHES:
  +------------------+-------------------+---------------------------+
  | Feature          | Rule-Based        | Machine Learning          |
  +------------------+-------------------+---------------------------+
  | How it learns    | Human writes rules| Learns from data          |
  | Transparency     | Very clear        | "Black box"               |
  | Flexibility      | Limited to rules  | Finds hidden patterns     |
  | Data needed      | None              | Lots of training data     |
  | Best for         | Simple analysis   | Complex predictions       |
  +------------------+-------------------+---------------------------+

StatSphere uses BOTH approaches to give users different perspectives
on player performance.


MATCH PREDICTION SYSTEM
------------------------
Location: backend/server.js (POST /api/predict-match)

A simpler prediction system for predicting match outcomes:

Formula:
  Team Score = (Attack × 0.4) + (Defense × 0.3) + (Form × 5)

  - Compare Team A score vs Team B score
  - Higher score = predicted winner
  - If scores are equal = predicted draw
  - Confidence = the difference between scores

This is a simple weighted formula (not machine learning).

COMPLEX CODE EXPLAINED
-----------------------

1. WEIGHTED FORMULA CALCULATION (Ballon d'Or Scoring)

   From BallonDor.js:

     function calculateScore(player) {
       var weight = leagueWeights[player.league] || 0.8;
       var goalsPer90 = 0;
       if (player.minutesPlayed > 0) {
         goalsPer90 = (player.goals / player.minutesPlayed) * 90;
       }
       var points = 0;
       points = points + (player.goals * 4);
       points = points + (player.assists * 3);
       points = points + (player.rating * 10);
       points = points + (player.keyPasses * 0.5);
       points = points + (goalsPer90 * 50);
       var finalScore = points * weight;
       return Math.round(finalScore * 10) / 10;
     }

   Line by line:
   - var weight = leagueWeights[player.league] || 0.8
     Look up the player's league in the leagueWeights object. For example,
     "Premier League" returns 1.0, "Saudi Pro League" returns 0.7. The
     || 0.8 means if the league is not in our list, use 0.8 as a default.
   - goalsPer90 = (player.goals / player.minutesPlayed) * 90
     This calculates how many goals the player scores per 90 minutes (a
     full match). A player with 20 goals in 2000 minutes gets
     (20/2000)*90 = 0.9 goals per game. This is fairer than raw goals
     because it accounts for playing time.
   - Each stat is multiplied by a different weight showing its importance:
     Goals x 4 (most important), Assists x 3, Rating x 10, Key Passes
     x 0.5, Goals/90 x 50. Higher multipliers mean that stat matters more.
   - finalScore = points * weight
     The total points are then multiplied by the league weight. A player
     scoring 30 goals in the Premier League (weight 1.0) keeps all their
     points. A player scoring 30 goals in the Saudi League (weight 0.7)
     loses 30% of their points because the league is considered easier.
   - Math.round(finalScore * 10) / 10
     This rounds to 1 decimal place. Multiplying by 10, rounding, then
     dividing by 10 turns 142.567 into 142.6.

2. LEAGUE WEIGHT CONCEPT

   From server.js (match predictions) and BallonDor.js:

     var leagueWeights = {
       "Premier League": 1.0,
       "La Liga": 0.95,
       "Serie A": 0.9,
       "Bundesliga": 0.9,
       "Ligue 1": 0.85,
       "Super Lig": 0.75,
       "Saudi Pro League": 0.7
     };

   What this means:
   - Not all football leagues are equally competitive. The Premier League
     is widely considered the strongest league in the world.
   - A weight of 1.0 means 100% of the player's stats count. A weight
     of 0.7 means only 70% counts.
   - Example: If Ronaldo (Saudi League, weight 0.7) and Haaland (Premier
     League, weight 1.0) both have a raw score of 200 points:
       Ronaldo: 200 x 0.7 = 140 final score
       Haaland: 200 x 1.0 = 200 final score
   - This reflects reality - the real Ballon d'Or voters also consider
     league difficulty when ranking players.
   - The weights are stored in a JavaScript object (dictionary), which
     lets us look up any league's weight in one line of code using
     bracket notation: leagueWeights["Premier League"] returns 1.0.

3. EXPECTED GOALS AND WIN PROBABILITY (Match Prediction)

   From server.js:

     var attackStrengthA = (teamA.attack / 100) * leagueWeightA;
     var defenseWeaknessB = 1 - (teamB.defense / 100);
     var avgGoals = 2.7;
     var expectedGoalsA = attackStrengthA * defenseWeaknessB * avgGoals;
     var formBonusA = 0.9 + ((teamA.form || 75) / 100) * 0.2;
     expectedGoalsA = expectedGoalsA * formBonusA;
     expectedGoalsA = expectedGoalsA * 1.10;  // home advantage

   Line by line:
   - attackStrengthA = (teamA.attack / 100) * leagueWeightA
     Convert the team's attack rating (0-100) to a 0-1 scale, then adjust
     for league strength. A team with 85 attack in the Premier League:
     (85/100) * 1.0 = 0.85.
   - defenseWeaknessB = 1 - (teamB.defense / 100)
     A strong defense (90) gives a low weakness (0.10). A weak defense
     (60) gives a high weakness (0.40). We calculate WEAKNESS because
     the opposing team scores more against weak defenses.
   - expectedGoalsA = attackStrengthA * defenseWeaknessB * 2.7
     This is inspired by the Poisson model used in real football analytics.
     2.7 is the average total goals per match in top European football.
     We multiply the attacker's strength by the opponent's defensive
     weakness by this average. For example: 0.85 * 0.40 * 2.7 = 0.918
     expected goals.
   - formBonusA = 0.9 + ((teamA.form || 75) / 100) * 0.2
     Form converts to a multiplier between 0.9 and 1.1. A team in great
     form (100) gets 0.9 + 0.2 = 1.1 (10% boost). A team in bad form
     (0) gets 0.9 (10% reduction). The || 75 provides a default.
   - expectedGoalsA * 1.10 is the home advantage - research shows home
     teams in football win about 46% of matches. A 10% boost to expected
     goals is a simplified version of this real-world effect.


DEFENCE TALKING POINTS
-----------------------

- "I used a weighted formula approach for the Ballon d'Or prediction
  because it is transparent and explainable. Unlike a black-box machine
  learning model, every part of the score can be traced back to specific
  stats. The weights (Goals x 4, Assists x 3, etc.) reflect how the real
  Ballon d'Or voters prioritise different contributions - goalscoring
  is valued most, followed by playmaking, then consistency."

- "League weights are a key innovation in my prediction model. They
  address a real problem in football analytics: raw stats across
  different leagues are not directly comparable. Scoring 20 goals in the
  Premier League is harder than scoring 20 goals in the Saudi Pro League
  because the opposition quality is different. My weights are based on
  UEFA coefficient rankings, which is the same system used by European
  football's governing body to rank league quality."

- "My match prediction system draws inspiration from real-world football
  analytics, specifically the Poisson distribution model. Professional
  betting companies and analytics firms like Opta use similar approaches
  where expected goals are calculated from attack strength and defensive
  weakness. My simplified version uses the average of 2.7 goals per match
  in European football as the baseline, then adjusts based on team
  ratings, league weights, form, and home advantage."

- "The application uses TWO prediction approaches: a simple weighted
  formula on the frontend for the Ballon d'Or (transparent, easy to
  understand) and a Python scikit-learn model in the ML module (learns
  patterns from data). This dual approach demonstrates my understanding
  of both rule-based systems and machine learning, and I can compare
  their strengths and weaknesses in my evaluation."

- "I validated my prediction model by checking if the top-ranked players
  match real-world Ballon d'Or candidates. The formula correctly ranks
  players like Haaland and Mbappe near the top because they have high
  goals, good ratings, and play in strong leagues. This is a form of
  face validity - the results make intuitive sense to anyone who follows
  football."

============================================================
END OF DOCUMENT
============================================================

